---
layout: mypost
title: Vue2-CLI脚手架进阶
categories: [Vue]
---

## 配置代理服务器

通过在vue.config.js中配置代理服务器，使得代理服务器的地址和端口号与本机相同，可以解决浏览器与服务器之间通信的跨域问题。

简单配置代理：

```js
devServer: {
  proxy: "http://localhost:5000"  //代理目标的基础路径
}
```

Tips：

- Vue中请求资源，直接发给前端本机即可
- 但这种方式不能配置多个代理，也不能灵活地控制请求是否走代理
- 会优先匹配前端本机的资源，若本机不存在，才会走代理转发给目标服务器

具体配置代理规则：

```js
devServer: {
	proxy: {
		'/api1': {  //匹配所有以/api1开头的请求路径
			target: 'http://localhost:5000',  //代理目标的基础路径
			changeOrigin: true,  //改变请求头的host地址为目标服务器的地址
			pathRewrite: {'^/api1': ''}  //去掉匹配路径前缀
		},
		'/api2': {  //匹配所有以/api2开头的请求路径
			target: 'http://localhost:5001',  //代理目标的基础路径
			changeOrigin: true,
			pathRewrite: {'^/api2': ''}
		}
  }
}
```

 Tips：

- 这种方式可以配置多个代理，且可以灵活地控制请求是否走代理
- Vue中请求资源时必须加路径前缀，并在代理配置中去掉前缀

## Vue中常用的两个Ajax库

1. axios：尤雨溪亲自推荐，当今最常用
2. vue-resource：Vue1.0时代遗留项目较多使用，当今已缺乏维护

## slot插槽

插槽可以让父组件向子组件的指定位置插入HTML结构。它也是组件间的一种通信方式，适用于父组件给子组件传递数据，只不过传递的数据为HTML结构。

slot插槽分为：默认插槽，具名插槽，作用域插槽。

默认插槽：最简单直接的插槽类型。
```vue
<!-- 父组件中 -->
<Category>
  <div>html结构</div>
</Category>


<!-- 子组件中 -->
<template>
  <div>
    <slot>插槽默认内容...</slot>  
  </div>
</template>
```

具名插槽：具有名称的插槽，用于多个插槽共存。

```vue
<!-- 父组件中 -->
<Category>
	<template slot="center">	<!-- 老式写法 -->
		<div>html结构1</div>
	</template>

	<template v-slot:footer> 	<!-- 新式写法 -->
		<div>html结构2</div>
	</template>
</Category>


<!-- 子组件中 -->
<template>
	<div>
		<slot name="center">插槽默认内容...</slot>
		<slot name="footer">插槽默认内容...</slot>
	</div>
</template>
```

作用域插槽：数据在子组件的自身，但根据数据生成的HTML结构需要组件的使用者（父组件）来决定。

```vue
<!-- 父组件中 -->
<Category>
  <template scope="scopeData">  <!-- 老式写法 -->
    <!-- 生成的是ul列表 -->
    <ul>
      <li v-for="g in scopeData.games" :key="g">{{g}}</li>
    </ul>
  </template>
</Category>

<Category>
  <template slot-scope="scopeData">  <!-- 新式写法 -->
    <!-- 生成的是h4标题 -->
    <h4 v-for="g in scopeData.games" :key="g">{{g}}</h4>
  </template>
</Category>


<!-- 子组件中 -->
<template>
  <div>
    <slot :games="games"></slot>
  </div>
</template>

<script>
export default {
  name: "Category",
  //数据在子组件自身
  data() {
    return {
      games: ["红色警戒", "穿越火线", "劲舞团", "超级玛丽"],
    };
  },
};
</script>

```

Tips：

- `scope="scopeData"`收到的是一个对象形式，包含了插槽提供的数据
- 作用域插槽也可以有名称，和具名插槽一样多个作用域插槽共存